<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EIP Gabriela Morreale - Curso 2024-2025</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar Navigation */
        .sidebar {
            width: 300px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 30px 20px;
            box-shadow: 2px 0 20px rgba(0, 0, 0, 0.1);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 1000;
            transition: transform 0.3s ease;
        }

        .sidebar.hidden {
            transform: translateX(-100%);
        }

        .logo {
            text-align: center;
            margin-bottom: 30px;
        }

        .logo h1 {
            color: #2c3e50;
            font-size: 1.8em;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .logo p {
            color: #7f8c8d;
            font-size: 0.9em;
        }

        .admin-access-btn {
            background: linear-gradient(135deg, #34495e, #2c3e50);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 500;
            width: 100%;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            opacity: 0.7;
        }

        .admin-access-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(52, 73, 94, 0.3);
            opacity: 1;
        }

        .edit-mode-toggle {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 500;
            width: 100%;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .edit-mode-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(243, 156, 18, 0.3);
        }

        .edit-mode-toggle.active {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
        }

        .nav-buttons {
            list-style: none;
        }

        .nav-button {
            margin-bottom: 10px;
        }

        .nav-button button {
            width: 100%;
            padding: 15px 20px;
            border: none;
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .nav-button button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(52, 152, 219, 0.3);
        }

        .nav-button button.active {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(231, 76, 60, 0.3);
        }

        .nav-button button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .nav-button button:hover::before {
            left: 100%;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 300px;
            padding: 40px;
            transition: margin-left 0.3s ease;
        }

        .main-content.full-width {
            margin-left: 0;
        }

        /* Home Page Styles */
        .home-page {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            max-width: 1000px;
            margin: 0 auto;
            text-align: center;
            animation: fadeIn 0.6s ease;
        }

        .home-header {
            margin-bottom: 40px;
        }

        .home-title {
            color: #2c3e50;
            font-size: 3em;
            font-weight: 300;
            margin-bottom: 15px;
            position: relative;
        }

        .home-subtitle {
            color: #7f8c8d;
            font-size: 1.3em;
            margin-bottom: 30px;
        }

        .logos-section {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 40px 0;
            padding: 30px;
            background: rgba(52, 73, 94, 0.05);
            border-radius: 15px;
        }

        .logo-item {
            text-align: center;
        }

        .logo-img {
            width: 120px;
            height: 120px;
            object-fit: contain;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo-img:hover {
            transform: scale(1.1);
        }

        .logo-label {
            margin-top: 15px;
            color: #2c3e50;
            font-weight: 500;
            font-size: 1.1em;
        }

        /* Section Buttons Grid */
        .sections-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }

        .section-card {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            border-radius: 20px;
            padding: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            text-align: left;
        }

        .section-card:nth-child(2) { background: linear-gradient(135deg, #e74c3c, #c0392b); }
        .section-card:nth-child(3) { background: linear-gradient(135deg, #27ae60, #2ecc71); }
        .section-card:nth-child(4) { background: linear-gradient(135deg, #f39c12, #e67e22); }
        .section-card:nth-child(5) { background: linear-gradient(135deg, #9b59b6, #8e44ad); }
        .section-card:nth-child(6) { background: linear-gradient(135deg, #1abc9c, #16a085); }
        .section-card:nth-child(7) { background: linear-gradient(135deg, #34495e, #2c3e50); }

        .section-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }

        .section-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s;
        }

        .section-card:hover::before {
            left: 100%;
        }

        .card-number {
            font-size: 2em;
            font-weight: 700;
            opacity: 0.3;
            position: absolute;
            top: 20px;
            right: 20px;
        }

        .card-title {
            font-size: 1.4em;
            font-weight: 600;
            margin-bottom: 10px;
            position: relative;
            z-index: 2;
        }

        .card-description {
            font-size: 1em;
            opacity: 0.9;
            line-height: 1.4;
            position: relative;
            z-index: 2;
        }

        /* Content Section Styles */
        .content-section {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            animation: fadeIn 0.6s ease;
            max-width: 1000px;
            margin: 0 auto;
            position: relative;
        }

        .content-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .section-header {
            margin-bottom: 30px;
            text-align: center;
            position: relative;
        }

        .section-header h2 {
            color: #2c3e50;
            font-size: 2.5em;
            font-weight: 300;
            margin-bottom: 10px;
            position: relative;
        }

        .section-header h2::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 3px;
            background: linear-gradient(135deg, #3498db, #e74c3c);
            border-radius: 2px;
        }

        .back-to-home {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            transition: all 0.3s ease;
            margin-bottom: 30px;
        }

        .back-to-home:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(149, 165, 166, 0.3);
        }

        .edit-button {
            position: absolute;
            top: 10px;
            right: 10px;
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 500;
            transition: all 0.3s ease;
            display: none;
        }

        .edit-mode .edit-button {
            display: block;
        }

        .edit-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(155, 89, 182, 0.3);
        }

        .section-content {
            line-height: 1.8;
            color: #34495e;
            font-size: 1.1em;
        }

        .section-content.editing {
            border: 2px dashed #3498db;
            padding: 20px;
            border-radius: 10px;
            background: #f8f9fa;
            position: relative;
        }

        .section-content h3 {
            color: #2c3e50;
            margin: 30px 0 15px 0;
            font-size: 1.4em;
        }

        .section-content ul {
            margin: 15px 0;
            padding-left: 25px;
        }

        .section-content li {
            margin-bottom: 8px;
        }

        .editor-toolbar {
            display: none;
            background: #2c3e50;
            color: white;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 15px;
            gap: 10px;
            flex-wrap: wrap;
        }

        .editor-toolbar.active {
            display: flex;
        }

        .editor-toolbar button {
            background: #34495e;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }

        .editor-toolbar button:hover {
            background: #4a5d6e;
        }

        .editor-actions {
            display: none;
            gap: 10px;
            margin-top: 15px;
        }

        .editor-actions.active {
            display: flex;
        }

        .save-btn {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .save-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(39, 174, 96, 0.3);
        }

        .cancel-btn {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .cancel-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(149, 165, 166, 0.3);
        }

        .editable-area {
            min-height: 200px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: white;
            font-family: inherit;
            font-size: inherit;
            line-height: inherit;
            color: inherit;
            outline: none;
            resize: vertical;
        }

        .editable-area:focus {
            border-color: #3498db;
            box-shadow: 0 0 10px rgba(52, 152, 219, 0.2);
        }

        .password-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .password-modal.show {
            display: flex;
        }

        .password-form {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            text-align: center;
            max-width: 400px;
            width: 90%;
        }

        .password-form h3 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .password-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1.1em;
            margin-bottom: 20px;
            outline: none;
            transition: border-color 0.3s ease;
        }

        .password-input:focus {
            border-color: #3498db;
        }

        .password-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .password-submit {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .password-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(39, 174, 96, 0.3);
        }

        .password-cancel {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .password-cancel:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(149, 165, 166, 0.3);
        }

        .password-error {
            color: #e74c3c;
            font-size: 0.9em;
            margin-top: 10px;
            display: none;
        }

        .progress-bar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.3);
            z-index: 1001;
            display: none;
        }

        .progress-bar.show {
            display: block;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #3498db, #e74c3c);
            width: 14.28%;
            transition: width 0.3s ease;
        }

        /* Mobile Toggle */
        .mobile-toggle {
            display: none;
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1002;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
            z-index: 1003;
            transform: translateX(300px);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .mobile-toggle {
                display: block;
            }

            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.show {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
                padding: 20px;
            }

            .content-section, .home-page {
                padding: 30px 20px;
            }

            .section-header h2, .home-title {
                font-size: 2em;
            }

            .logos-section {
                flex-direction: column;
                gap: 20px;
            }

            .sections-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .editor-toolbar {
                justify-content: flex-start;
            }
        }
    </style>
</head>
<body>
    <div class="progress-bar" id="progressBar">
        <div class="progress-fill" id="progressFill"></div>
    </div>

    <div class="notification" id="notification">
        ¡Cambios guardados correctamente!
    </div>

    <div class="password-modal" id="passwordModal">
        <div class="password-form">
            <h3>🔐 Acceso de Administrador</h3>
            <p>Introduce la contraseña para activar el modo edición:</p>
            <input type="password" class="password-input" id="passwordInput" placeholder="Contraseña">
            <div class="password-error" id="passwordError">Contraseña incorrecta. Inténtalo de nuevo.</div>
            <div class="password-buttons">
                <button class="password-submit" onclick="checkPassword()">Acceder</button>
                <button class="password-cancel" onclick="closePasswordModal()">Cancelar</button>
            </div>
        </div>
    </div>

    <button class="mobile-toggle" onclick="toggleSidebar()">
        ☰
    </button>

    <div class="container">
        <nav class="sidebar" id="sidebar">
            <div class="logo">
                <h1>EIP Gabriela Morreale</h1>
                <p>Curso 2024-2025</p>
            </div>
            
            <button class="edit-mode-toggle" onclick="requestEditMode()" id="editModeToggle" style="display: none;">
                📝 Activar Edición
            </button>
            
            <button class="admin-access-btn" onclick="showPasswordPrompt()" id="adminAccessBtn">
                🔐 Acceso Administrador
            </button>
            
            <ul class="nav-buttons">
                <li class="nav-button">
                    <button onclick="showHome()" class="active">🏠 Inicio</button>
                </li>
                <li class="nav-button">
                    <button onclick="showSection(0)">1. Introducción</button>
                </li>
                <li class="nav-button">
                    <button onclick="showSection(1)">2. Órganos</button>
                </li>
                <li class="nav-button">
                    <button onclick="showSection(2)">3. Presentación</button>
                </li>
                <li class="nav-button">
                    <button onclick="showSection(3)">4. Funcionamiento</button>
                </li>
                <li class="nav-button">
                    <button onclick="showSection(4)">5. Actividades Extraescolares</button>
                </li>
                <li class="nav-button">
                    <button onclick="showSection(5)">6. Actividades Propias</button>
                </li>
                <li class="nav-button">
                    <button onclick="showSection(6)">7. Otras Informaciones</button>
                </li>
            </ul>
        </nav>

        <main class="main-content" id="mainContent">
            <!-- Home Page -->
            <div class="home-page" id="homePage">
                <div class="home-header">
                    <h1 class="home-title">EIP Gabriela Morreale</h1>
                    <p class="home-subtitle">Curso Académico 2024-2025</p>
                </div>

                <div class="logos-section">
                    <div class="logo-item">
                        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAD6CAYAAAC/aNTSAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDcuMC1jMDAwIDc5LjIxN2M5N2YsIDIwMjEvMTAvMDQtMTQ6MTk6NDIgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCAyMy4wIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoyN0E1MjNDMUY4NTExMUVDOUZGRkU2OUNEMkE5RDJFNyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoyN0E1MjNDMkY4NTExMUVDOUZGRkU2OUNEMkE5RDJFNyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjI3QTUyM0JGRjg1MTExRUM5RkZGRTY5Q0QyQTlEMkU3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjI3QTUyM0MwRjg1MTExRUM5RkZGRTY5Q0QyQTlEMkU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+UPj/2AAAAIRJREFUeNrs3UFqAjEUBuAX9QBeCe9/Ja+kJ7CnsAu7sIv8H2YgJJN5774fAgSI4H+fJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJP2PJwEGAL7bCMZt1FXNAAAAAElFTkSuQmCC" alt="Logo Ayuntamiento Leganés" class="logo-img" style="background: #2E86C1; padding: 20px;">
                        <p class="logo-label">Ayuntamiento de Leganés</p>
                    </div>
                    <div class="logo-item">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjQwMCIgdmlld0JveD0iMCAwIDMwMCA0MDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIzMDAiIGhlaWdodD0iNDAwIiBmaWxsPSJ3aGl0ZSIvPgo8IS0tIEEuTS5QLkEuIHRleHQgLS0+Cjx0ZXh0IHg9IjE1MCIgeT0iNDAiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIzNiIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IiM0Q0FGNTAIL0YiIHRleHQtYW5jaG9yPSJtaWRkbGUiPkEuIE0uIFAuIEEuPC90ZXh0PgoKPCEtLSBNaWNyb3Njb3BlIC0tPgo8Y2lyY2xlIGN4PSIxODAiIGN5PSIxMDAiIHI9IjIwIiBmaWxsPSIjNENBRjUwIi8+CjxjaXJjbGUgY3g9IjE5NSIgY3k9IjEwNSIgcj0iNSIgZmlsbD0iIzRDQUY1MCIvPgo8cGF0aCBkPSJNMTY1IDEwNUwxOTUgMTM1TDIwNSAxMjVMMTc1IDk1WiIgZmlsbD0iIzRDQUY1MCIvPgoKPCEtLSBTaWxob3VldHRlIGhlYWQgLS0+CjxwYXRoIGQ9Ik04MCAxMDBDODAgMTAwIDcwIDEwNSA2NSAxMjBDNjAgMTM1IDY1IDE2MCA4MCAyMDBDMTAwIDI0MCA5MCAyNTAgOTAgMjUwSDEyMEM5MCAyNTAgOTAgMjEwIDExMCAyMDBDMTI1IDE2MDE0MDE0NQMxNDIzNwC0yTIDEyOEMxMzUgMTA1IDEyOCAxMDAgODAgMTAwWiIgZmlsbD0iI0Q2OUU3NSIvPgoKPCEtLSBMRUdBTsOJUyB0ZXh0IC0tPgo8dGV4dCB4PSIyMDAiIHk9IjI2MCIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmaWxsPSIjMzMzIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5MRUdBTsOJUzwvdGV4dD4KCjwhLS0gQ0VJUCAtLT4KPHN2ZyB4PSIxNTAiIHk9IjI4MCIgd2lkdGg9IjEyMCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDEyMCA0MCI+CjwhLS0gQmVha2VycyAtLT4KPGNpcmNsZSBjeD0iMjAiIGN5PSIzMCIgcj0iNSIgZmlsbD0iI0ZGQzEwNyIvPgo8Y2lyY2xlIGN4PSI0MCIgY3k9IjMwIiByPSI1IiBmaWxsPSIjRkZDMTA3Ii8+CjxjaXJjbGUgY3g9IjYwIiBjeT0iMzAiIHI9IjUiIGZpbGw9IiNGRkMxMDciLz4KPGJ0Y2lyY2xlIGN4PSI5MCIgY3k9IjIwIiByPSI4IiBmaWxsPSIjRkZDMTA3Ii8+CjwhLS0gQm9vayAtLT4KPHJlY3QgeD0iODAiIHk9IjE1IiB3aWR0aD0iMzAiIGhlaWdodD0iMjAiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzMzMyIgc3Ryb2tlLXdpZHRoPSIxLjUiLz4KPGxpbmUgeDE9Ijg1IiB5MT0iMTUiIHgyPSI4NSIgeTI9IjM1IiBzdHJva2U9IiMzMzMiLz4KPGE+Cjwvc3ZnPgoKPCEtLSBDRUlQIHRleHQgLS0+Cjx0ZXh0IHg9IjE1MCIgeT0iMzMwIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTYiIGZvbnQtd2VpZ2h0PSJib2xkIiBmaWxsPSIjNENBRjUwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5DRUlQPC90ZXh0PgoKPCEtLSBHQUJSSUVMQSBNT1JSRUFMRSBjdXJ2ZWQgdGV4dCAtLT4KPGRlZnM+CjxwYXRoIGlkPSJjdXJ2ZSIgZD0iTTMwIDM2MEMxMDAgMzUwIDE1MCAzNTUgMjcwIDM2NSIvPgo8L2RlZnM+Cjx0ZXh0IGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIyMCIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IiM0Q0FGNTAI+Cjx0ZXh0UGF0aCBocmVmPSIjY3VydmUiPkdBQlJJRUxBIE1PUlJFQUxFPC90ZXh0UGF0aD4KPC90ZXh0Pgo8L3N2Zz4K" alt="Logo AMPA" class="logo-img">
                        <p class="logo-label">AMPA CEIP Gabriela Morreale</p>
                    </div>
                </div>

                <div class="sections-grid">
                    <button class="section-card" onclick="showSection(0)">
                        <div class="card-number">1</div>
                        <div class="card-title">Introducción</div>
                        <div class="card-description">Bienvenida al centro educativo y presentación general de la guía</div>
                    </button>

                    <button class="section-card" onclick="showSection(1)">
                        <div class="card-number">2</div>
                        <div class="card-title">Órganos</div>
                        <div class="card-description">Estructura organizativa y órganos de gobierno del centro</div>
                    </button>

                    <button class="section-card" onclick="showSection(2)">
                        <div class="card-number">3</div>
                        <div class="card-title">Presentación</div>
                        <div class="card-description">Misión, visión y valores del EIP Gabriela Morreale</div>
                    </button>

                    <button class="section-card" onclick="showSection(3)">
                        <div class="card-number">4</div>
                        <div class="card-title">Funcionamiento</div>
                        <div class="card-description">Horarios, normas de convivencia y procedimientos del centro</div>
                    </button>

                    <button class="section-card" onclick="showSection(4)">
                        <div class="card-number">5</div>
                        <div class="card-title">Actividades Extraescolares</div>
                        <div class="card-description">Oferta de actividades deportivas, culturales y tecnológicas</div>
                    </button>

                    <button class="section-card" onclick="showSection(5)">
                        <div class="card-number">6</div>
                        <div class="card-title">Actividades Propias</div>
                        <div class="card-description">Proyectos pedagógicos y eventos especiales del centro</div>
                    </button>

                    <button class="section-card" onclick="showSection(6)">
                        <div class="card-number">7</div>
                        <div class="card-title">Otras Informaciones</div>
                        <div class="card-description">Contacto, servicios complementarios y recursos útiles</div>
                    </button>
                </div>
            </div>

            <!-- Sección 1: Introducción -->
            <section class="content-section" id="section-0">
                <button class="back-to-home" onclick="showHome()">← Volver al Inicio</button>
                <button class="edit-button" onclick="editSection(0)">✏️ Editar</button>
                <div class="section-header">
                    <h2>Introducción</h2>
                </div>
                <div class="editor-toolbar" id="toolbar-0">
                    <button onclick="formatText('bold')"><b>B</b></button>
                    <button onclick="formatText('italic')"><i>I</i></button>
                    <button onclick="formatText('underline')"><u>U</u></button>
                    <button onclick="insertHeading()">H3</button>
                    <button onclick="insertList()">Lista</button>
                    <button onclick="insertLink()">🔗 Enlace</button>
                </div>
                <div class="section-content" id="content-0">
                    <p>Bienvenidos al <strong>EIP Gabriela Morreale</strong> para el curso académico 2024-2025.</p>
                    
                    <p>Esta presentación interactiva le permitirá navegar por las diferentes secciones de nuestro centro educativo, conocer su funcionamiento, órganos de gobierno, actividades y toda la información relevante para el presente curso.</p>
                    
                    <h3>¿Qué encontrará en esta guía?</h3>
                    <ul>
                        <li><strong>Órganos de gobierno:</strong> Estructura organizativa del centro</li>
                        <li><strong>Presentación general:</strong> Misión, visión y valores</li>
                        <li><strong>Funcionamiento:</strong> Normativa y procedimientos</li>
                        <li><strong>Actividades extraescolares:</strong> Oferta complementaria</li>
                        <li><strong>Actividades propias:</strong> Programas específicos del centro</li>
                        <li><strong>Información adicional:</strong> Contacto y recursos</li>
                    </ul>
                    
                    <p>Utilice los botones de navegación del lateral izquierdo o regrese al inicio para acceder a cada sección.</p>
                </div>
                <div class="editor-actions" id="actions-0">
                    <button class="save-btn" onclick="saveSection(0)">💾 Guardar</button>
                    <button class="cancel-btn" onclick="cancelEdit(0)">❌ Cancelar</button>
                </div>
            </section>

            <!-- Sección 2: Órganos -->
            <section class="content-section" id="section-1">
                <button class="back-to-home" onclick="showHome()">← Volver al Inicio</button>
                <button class="edit-button" onclick="editSection(1)">✏️ Editar</button>
                <div class="section-header">
                    <h2>Órganos</h2>
                </div>
                <div class="editor-toolbar" id="toolbar-1">
                    <button onclick="formatText('bold')"><b>B</b></button>
                    <button onclick="formatText('italic')"><i>I</i></button>
                    <button onclick="formatText('underline')"><u>U</u></button>
                    <button onclick="insertHeading()">H3</button>
                    <button onclick="insertList()">Lista</button>
                    <button onclick="insertLink()">🔗 Enlace</button>
                </div>
                <div class="section-content" id="content-1">
                    <p>Los órganos de gobierno y coordinación docente del EIP Gabriela Morreale están estructurados para garantizar una gestión eficaz y una educación de calidad.</p>
                    
                    <h3>Órganos de Gobierno</h3>
                    <ul>
                        <li><strong>Dirección:</strong> Órgano ejecutivo de gobierno</li>
                        <li><strong>Consejo Escolar:</strong> Órgano de participación de la comunidad educativa</li>
                        <li><strong>Claustro de Profesores:</strong> Órgano propio de participación de los profesores</li>
                    </ul>
                    
                    <h3>Órganos de Coordinación Docente</h3>
                    <ul>
                        <li><strong>Equipos de ciclo:</strong> Coordinación por etapas educativas</li>
                        <li><strong>Comisión de Coordinación Pedagógica:</strong> Coordinación curricular</li>
                        <li><strong>Departamento de Orientación:</strong> Apoyo educativo y orientación</li>
                    </ul>
                    
                    <p>Cada órgano tiene funciones específicas definidas por la normativa vigente y el proyecto educativo del centro.</p>
                </div>
                <div class="editor-actions" id="actions-1">
                    <button class="save-btn" onclick="saveSection(1)">💾 Guardar</button>
                    <button class="cancel-btn" onclick="cancelEdit(1)">❌ Cancelar</button>
                </div>
            </section>

            <!-- Sección 3: Presentación -->
            <section class="content-section" id="section-2">
                <button class="back-to-home" onclick="showHome()">← Volver al Inicio</button>
                <button class="edit-button" onclick="editSection(2)">✏️ Editar</button>
                <div class="section-header">
                    <h2>Presentación</h2>
                </div>
                <div class="editor-toolbar" id="toolbar-2">
                    <button onclick="formatText('bold')"><b>B</b></button>
                    <button onclick="formatText('italic')"><i>I</i></button>
                    <button onclick="formatText('underline')"><u>U</u></button>
                    <button onclick="insertHeading()">H3</button>
                    <button onclick="insertList()">Lista</button>
                    <button onclick="insertLink()">🔗 Enlace</button>
                </div>
                <div class="section-content" id="content-2">
                    <p>El <strong>EIP Gabriela Morreale</strong> es un centro educativo comprometido con la excelencia académica y el desarrollo integral de nuestro alumnado.</p>
                    
                    <h3>Nuestra Misión</h3>
                    <p>Proporcionar una educación de calidad que forme personas competentes, responsables y comprometidas con su entorno, desarrollando todas sus capacidades y potencialidades.</p>
                    
                    <h3>Nuestra Visión</h3>
                    <p>Ser un centro educativo de referencia, innovador y participativo, que prepare a sus estudiantes para los retos del siglo XXI con una sólida formación académica y humana.</p>
                    
                    <h3>Nuestros Valores</h3>
                    <ul>
                        <li><strong>Respeto:</strong> Por la diversidad y la dignidad de todas las personas</li>
                        <li><strong>Responsabilidad:</strong> En el aprendizaje y la convivencia</li>
                        <li><strong>Solidaridad:</strong> Y compromiso con la comunidad</li>
                        <li><strong>Innovación:</strong> En metodologías y recursos educativos</li>
                        <li><strong>Participación:</strong> De toda la comunidad educativa</li>
                    </ul>
                </div>
                <div class="editor-actions" id="actions-2">
                    <button class="save-btn" onclick="saveSection(2)">💾 Guardar</button>
                    <button class="cancel-btn" onclick="cancelEdit(2)">❌ Cancelar</button>
                </div>
            </section>

            <!-- Sección 4: Funcionamiento -->
            <section class="content-section" id="section-3">
                <button class="back-to-home" onclick="showHome()">← Volver al Inicio</button>
                <button class="edit-button" onclick="editSection(3)">✏️ Editar</button>
                <div class="section-header">
                    <h2>Funcionamiento</h2>
                </div>
                <div class="editor-toolbar" id="toolbar-3">
                    <button onclick="formatText('bold')"><b>B</b></button>
                    <button onclick="formatText('italic')"><i>I</i></button>
                    <button onclick="formatText('underline')"><u>U</u></button>
                    <button onclick="insertHeading()">H3</button>
                    <button onclick="insertList()">Lista</button>
                    <button onclick="insertLink()">🔗 Enlace</button>
                </div>
                <div class="section-content" id="content-3">
                    <p>El funcionamiento del centro se rige por la normativa educativa vigente y nuestro Reglamento de Régimen Interior.</p>
                    
                    <h3>Horarios</h3>
                    <ul>
                        <li><strong>Jornada lectiva:</strong> De 9:00 a 14:00 horas</li>
                        <li><strong>Recreo:</strong> De 11:30 a 12:00 horas</li>
                        <li><strong>Atención a familias:</strong> Martes de 14:00 a 15:00 horas</li>
                    </ul>
                    
                    <h3>Normas de Convivencia</h3>
                    <ul>
                        <li>Respeto hacia todas las personas de la comunidad educativa</li>
                        <li>Puntualidad en la asistencia a clase</li>
                        <li>Cuidado de las instalaciones y materiales</li>
                        <li>Participación activa en las actividades del centro</li>
                    </ul>
                    
                    <h3>Procedimientos</h3>
                    <p>Todos los procedimientos administrativos y educativos están claramente definidos y son comunicados a las familias a través de los canales oficiales del centro.</p>
                </div>
                <div class="editor-actions" id="actions-3">
                    <button class="save-btn" onclick="saveSection(3)">💾 Guardar</button>
                    <button class="cancel-btn" onclick="cancelEdit(3)">❌ Cancelar</button>
                </div>
            </section>

            <!-- Sección 5: Actividades Extraescolares -->
            <section class="content-section" id="section-4">
                <button class="back-to-home" onclick="showHome()">← Volver al Inicio</button>
                <button class="edit-button" onclick="editSection(4)">✏️ Editar</button>
                <div class="section-header">
                    <h2>Actividades Extraescolares</h2>
                </div>
                <div class="editor-toolbar" id="toolbar-4">
                    <button onclick="formatText('bold')"><b>B</b></button>
                    <button onclick="formatText('italic')"><i>I</i></button>
                    <button onclick="formatText('underline')"><u>U</u></button>
                    <button onclick="insertHeading()">H3</button>
                    <button onclick="insertList()">Lista</button>
                    <button onclick="insertLink()">🔗 Enlace</button>
                </div>
                <div class="section-content" id="content-4">
                    <p>Nuestro centro ofrece una amplia variedad de actividades extraescolares que complementan la formación académica y contribuyen al desarrollo integral del alumnado.</p>
                    
                    <h3>Actividades Deportivas</h3>
                    <ul>
                        <li>Fútbol sala</li>
                        <li>Baloncesto</li>
                        <li>Atletismo</li>
                        <li>Natación</li>
                    </ul>
                    
                    <h3>Actividades Artísticas y Culturales</h3>
                    <ul>
                        <li>Coro escolar</li>
                        <li>Teatro</li>
                        <li>Artes plásticas</li>
                        <li>Taller de lectura</li>
                    </ul>
                    
                    <h3>Actividades Tecnológicas</h3>
                    <ul>
                        <li>Robótica educativa</li>
                        <li>Programación básica</li>
                        <li>Taller de ciencias</li>
                    </ul>
                    
                    <p>Las inscripciones se realizan al comienzo de cada trimestre. Todas las actividades son voluntarias y tienen un coste adicional que se comunica previamente a las familias.</p>
                </div>
                <div class="editor-actions" id="actions-4">
                    <button class="save-btn" onclick="saveSection(4)">💾 Guardar</button>
                    <button class="cancel-btn" onclick="cancelEdit(4)">❌ Cancelar</button>
                </div>
            </section>

            <!-- Sección 6: Actividades Propias -->
            <section class="content-section" id="section-5">
                <button class="back-to-home" onclick="showHome()">← Volver al Inicio</button>
                <button class="edit-button" onclick="editSection(5)">✏️ Editar</button>
                <div class="section-header">
                    <h2>Actividades Propias</h2>
                </div>
                <div class="editor-toolbar" id="toolbar-5">
                    <button onclick="formatText('bold')"><b>B</b></button>
                    <button onclick="formatText('italic')"><i>I</i></button>
                    <button onclick="formatText('underline')"><u>U</u></button>
                    <button onclick="insertHeading()">H3</button>
                    <button onclick="insertList()">Lista</button>
                    <button onclick="insertLink()">🔗 Enlace</button>
                </div>
                <div class="section-content" id="content-5">
                    <p>El centro desarrolla actividades propias que forman parte de nuestro proyecto educativo y que enriquecen la experiencia escolar de nuestro alumnado.</p>
                    
                    <h3>Proyectos Pedagógicos</h3>
                    <ul>
                        <li><strong>Proyecto bilingüe:</strong> Enseñanza en inglés en áreas no lingüísticas</li>
                        <li><strong>Huerto escolar:</strong> Aprendizaje medioambiental práctico</li>
                        <li><strong>Mediación escolar:</strong> Resolución pacífica de conflictos</li>
                        <li><strong>Biblioteca activa:</strong> Fomento de la lectura</li>
                    </ul>
                    
                    <h3>Celebraciones y Eventos</h3>
                    <ul>
                        <li>Día de la Paz</li>
                        <li>Semana Cultural</li>
                        <li>Festival de Navidad</li>
                        <li>Graduación de 6º</li>
                        <li>Día del Libro</li>
                    </ul>
                    
                    <h3>Salidas Educativas</h3>
                    <p>Organizamos salidas didácticas adaptadas a cada nivel educativo que complementan el currículo y proporcionan experiencias de aprendizaje enriquecedoras.</p>
                </div>
                <div class="editor-actions" id="actions-5">
                    <button class="save-btn" onclick="saveSection(5)">💾 Guardar</button>
                    <button class="cancel-btn" onclick="cancelEdit(5)">❌ Cancelar</button>
                </div>
            </section>

            <!-- Sección 7: Otras Informaciones -->
            <section class="content-section" id="section-6">
                <button class="back-to-home" onclick="showHome()">← Volver al Inicio</button>
                <button class="edit-button" onclick="editSection(6)">✏️ Editar</button>
                <div class="section-header">
                    <h2>Otras Informaciones</h2>
                </div>
                <div class="editor-toolbar" id="toolbar-6">
                    <button onclick="formatText('bold')"><b>B</b></button>
                    <button onclick="formatText('italic')"><i>I</i></button>
                    <button onclick="formatText('underline')"><u>U</u></button>
                    <button onclick="insertHeading()">H3</button>
                    <button onclick="insertList()">Lista</button>
                    <button onclick="insertLink()">🔗 Enlace</button>
                </div>
                <div class="section-content" id="content-6">
                    <h3>Información de Contacto</h3>
                    <p><strong>Dirección:</strong> [Dirección del centro]</p>
                    <p><strong>Teléfono:</strong> [Número de teléfono]</p>
                    <p><strong>Email:</strong> [Correo electrónico]</p>
                    <p><strong>Página web:</strong> [Sitio web del centro]</p>
                    
                    <h3>Servicios Complementarios</h3>
                    <ul>
                        <li><strong>Comedor escolar:</strong> Menús equilibrados y adaptados</li>
                        <li><strong>Transporte escolar:</strong> Rutas disponibles</li>
                        <li><strong>Madrugadores:</strong> Acogida temprana</li>
                        <li><strong>Apoyo educativo:</strong> Atención a la diversidad</li>
                    </ul>
                    
                    <h3>Recursos y Enlaces</h3>
                    <ul>
                        <li>Portal de la Comunidad de Madrid</li>
                        <li>Plataforma educativa del centro</li>
                        <li>AMPA - Asociación de Madres y Padres</li>
                        <li>Consejería de Educación</li>
                    </ul>
                    
                    <h3>Documentos Importantes</h3>
                    <ul>
                        <li>Proyecto Educativo de Centro (PEC)</li>
                        <li>Programación General Anual (PGA)</li>
                        <li>Reglamento de Régimen Interior (RRI)</li>
                        <li>Plan de Convivencia</li>
                        <li>Memoria Anual</li>
                    </ul>
                    
                    <p><strong>¡Gracias por su interés en el EIP Gabriela Morreale!</strong></p>
                    <p>Para cualquier consulta adicional, no dude en ponerse en contacto con nosotros a través de los canales oficiales del centro.</p>
                </div>
                <div class="editor-actions" id="actions-6">
                    <button class="save-btn" onclick="saveSection(6)">💾 Guardar</button>
                    <button class="cancel-btn" onclick="cancelEdit(6)">❌ Cancelar</button>
                </div>
            </section>
        </main>
    </div>

    <script>
        // Function to handle logo loading
        async function loadLogos() {
            try {
                // Try to load the uploaded images
                const ampaLogo = document.getElementById('ampa-logo');
                const ayuntamientoLogo = document.getElementById('ayuntamiento-logo');
                
                // Check if files are available
                if (window.fs) {
                    // This would work if the images were uploaded to the session
                    // For now, we'll use placeholder logos that are visible
                }
            } catch (error) {
                console.log('Using fallback logos');
            }
        }
        const ADMIN_PASSWORD = "eip2024admin";
        
        let currentSection = -1; // -1 means home page
        const totalSections = 7;
        let editMode = false;
        let originalContent = {};
        let currentEditingSection = null;
        let isAuthenticated = false;

        // Navigation functions
        function showHome() {
            // Cancel any active editing first
            if (currentEditingSection !== null) {
                cancelEdit(currentEditingSection);
            }
            
            // Hide all content sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.style.display = 'none';
            });
            
            // Show home page
            document.getElementById('homePage').style.display = 'block';
            
            // Remove active class from all buttons and add to home
            document.querySelectorAll('.nav-button button').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector('.nav-button button').classList.add('active');
            
            // Update current section
            currentSection = -1;
            
            // Hide progress bar on home
            document.getElementById('progressBar').classList.remove('show');
            
            // Close sidebar on mobile after selection
            if (window.innerWidth <= 768) {
                document.getElementById('sidebar').classList.remove('show');
            }
        }

        function showSection(sectionIndex) {
            // Cancel any active editing first
            if (currentEditingSection !== null) {
                cancelEdit(currentEditingSection);
            }
            
            // Hide home page
            document.getElementById('homePage').style.display = 'none';
            
            // Hide all content sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.style.display = 'none';
            });
            
            // Show selected section
            document.getElementById(`section-${sectionIndex}`).style.display = 'block';
            
            // Remove active class from all buttons
            document.querySelectorAll('.nav-button button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Add active class to corresponding button (sectionIndex + 1 because home is index 0)
            document.querySelectorAll('.nav-button button')[sectionIndex + 1].classList.add('active');
            
            // Update current section
            currentSection = sectionIndex;
            
            // Show and update progress bar
            document.getElementById('progressBar').classList.add('show');
            updateProgressBar();
            
            // Close sidebar on mobile after selection
            if (window.innerWidth <= 768) {
                document.getElementById('sidebar').classList.remove('show');
            }
        }

        function updateProgressBar() {
            if (currentSection >= 0) {
                const progressWidth = ((currentSection + 1) / totalSections) * 100;
                document.getElementById('progressFill').style.width = progressWidth + '%';
            }
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('show');
        }

        // Authentication functions
        function showPasswordPrompt() {
            document.getElementById('passwordModal').classList.add('show');
            document.getElementById('passwordInput').focus();
        }

        function closePasswordModal() {
            document.getElementById('passwordModal').classList.remove('show');
            document.getElementById('passwordInput').value = '';
            document.getElementById('passwordError').style.display = 'none';
        }

        function checkPassword() {
            const inputPassword = document.getElementById('passwordInput').value;
            const errorDiv = document.getElementById('passwordError');
            
            if (inputPassword === ADMIN_PASSWORD) {
                isAuthenticated = true;
                closePasswordModal();
                enableAdminMode();
                showNotification('¡Modo administrador activado!');
            } else {
                errorDiv.style.display = 'block';
                document.getElementById('passwordInput').value = '';
                document.getElementById('passwordInput').focus();
            }
        }

        function enableAdminMode() {
            document.getElementById('adminAccessBtn').style.display = 'none';
            document.getElementById('editModeToggle').style.display = 'block';
        }

        function requestEditMode() {
            if (!isAuthenticated) {
                showPasswordPrompt();
                return;
            }
            toggleEditMode();
        }

        // Edit mode functions
        function toggleEditMode() {
            if (!isAuthenticated) {
                showNotification('Acceso no autorizado. Necesitas permisos de administrador.', 'error');
                return;
            }
            
            editMode = !editMode;
            const toggle = document.getElementById('editModeToggle');
            const body = document.body;
            
            if (editMode) {
                body.classList.add('edit-mode');
                toggle.textContent = '👁️ Modo Vista';
                toggle.classList.add('active');
            } else {
                body.classList.remove('edit-mode');
                toggle.textContent = '📝 Activar Edición';
                toggle.classList.remove('active');
                
                // Cancel any active editing
                if (currentEditingSection !== null) {
                    cancelEdit(currentEditingSection);
                }
            }
        }

        function editSection(sectionIndex) {
            if (!editMode) return;
            
            // Cancel any other editing first
            if (currentEditingSection !== null && currentEditingSection !== sectionIndex) {
                cancelEdit(currentEditingSection);
            }
            
            currentEditingSection = sectionIndex;
            const contentDiv = document.getElementById(`content-${sectionIndex}`);
            const toolbar = document.getElementById(`toolbar-${sectionIndex}`);
            const actions = document.getElementById(`actions-${sectionIndex}`);
            
            // Store original content
            originalContent[sectionIndex] = contentDiv.innerHTML;
            
            // Create editable textarea
            const currentContent = contentDiv.innerHTML;
            contentDiv.innerHTML = `<textarea class="editable-area" id="editor-${sectionIndex}">${currentContent}</textarea>`;
            
            // Show toolbar and actions
            toolbar.classList.add('active');
            actions.classList.add('active');
            contentDiv.classList.add('editing');
            
            // Focus on textarea
            document.getElementById(`editor-${sectionIndex}`).focus();
        }

        function saveSection(sectionIndex) {
            const editor = document.getElementById(`editor-${sectionIndex}`);
            const contentDiv = document.getElementById(`content-${sectionIndex}`);
            const toolbar = document.getElementById(`toolbar-${sectionIndex}`);
            const actions = document.getElementById(`actions-${sectionIndex}`);
            
            if (!editor) return;
            
            // Get new content and update
            const newContent = editor.value;
            contentDiv.innerHTML = newContent;
            
            // Hide toolbar and actions
            toolbar.classList.remove('active');
            actions.classList.remove('active');
            contentDiv.classList.remove('editing');
            
            // Clear editing state
            currentEditingSection = null;
            delete originalContent[sectionIndex];
            
            // Show notification
            showNotification('¡Cambios guardados correctamente!');
        }

        function cancelEdit(sectionIndex) {
            const contentDiv = document.getElementById(`content-${sectionIndex}`);
            const toolbar = document.getElementById(`toolbar-${sectionIndex}`);
            const actions = document.getElementById(`actions-${sectionIndex}`);
            
            // Restore original content
            if (originalContent[sectionIndex]) {
                contentDiv.innerHTML = originalContent[sectionIndex];
                delete originalContent[sectionIndex];
            }
            
            // Hide toolbar and actions
            toolbar.classList.remove('active');
            actions.classList.remove('active');
            contentDiv.classList.remove('editing');
            
            // Clear editing state
            currentEditingSection = null;
        }

        // Formatting functions
        function formatText(command) {
            if (currentEditingSection === null) return;
            
            const editor = document.getElementById(`editor-${currentEditingSection}`);
            if (!editor) return;
            
            const start = editor.selectionStart;
            const end = editor.selectionEnd;
            const selectedText = editor.value.substring(start, end);
            
            if (!selectedText) {
                alert('Por favor, selecciona el texto que quieres formatear.');
                return;
            }
            
            let formattedText = '';
            switch (command) {
                case 'bold':
                    formattedText = `<strong>${selectedText}</strong>`;
                    break;
                case 'italic':
                    formattedText = `<em>${selectedText}</em>`;
                    break;
                case 'underline':
                    formattedText = `<u>${selectedText}</u>`;
                    break;
            }
            
            editor.value = editor.value.substring(0, start) + formattedText + editor.value.substring(end);
            editor.focus();
        }

        function insertHeading() {
            if (currentEditingSection === null) return;
            
            const editor = document.getElementById(`editor-${currentEditingSection}`);
            if (!editor) return;
            
            const headingText = prompt('Introduce el texto del encabezado:');
            if (headingText) {
                const cursorPos = editor.selectionStart;
                const heading = `<h3>${headingText}</h3>`;
                editor.value = editor.value.substring(0, cursorPos) + heading + editor.value.substring(cursorPos);
                editor.focus();
            }
        }

        function insertList() {
            if (currentEditingSection === null) return;
            
            const editor = document.getElementById(`editor-${currentEditingSection}`);
            if (!editor) return;
            
            const listItems = prompt('Introduce los elementos de la lista separados por comas:');
            if (listItems) {
                const items = listItems.split(',').map(item => `<li>${item.trim()}</li>`).join('\n');
                const list = `<ul>\n${items}\n</ul>`;
                const cursorPos = editor.selectionStart;
                editor.value = editor.value.substring(0, cursorPos) + list + editor.value.substring(cursorPos);
                editor.focus();
            }
        }

        function insertLink() {
            if (currentEditingSection === null) return;
            
            const editor = document.getElementById(`editor-${currentEditingSection}`);
            if (!editor) return;
            
            const url = prompt('Introduce la URL del enlace:');
            if (url) {
                const text = prompt('Introduce el texto del enlace:') || url;
                const link = `<a href="${url}" target="_blank">${text}</a>`;
                const cursorPos = editor.selectionStart;
                editor.value = editor.value.substring(0, cursorPos) + link + editor.value.substring(cursorPos);
                editor.focus();
            }
        }

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            
            // Change color based on type
            if (type === 'error') {
                notification.style.background = 'linear-gradient(135deg, #e74c3c, #c0392b)';
            } else {
                notification.style.background = 'linear-gradient(135deg, #27ae60, #2ecc71)';
            }
            
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Enhanced keyboard navigation
        document.addEventListener('keydown', function(e) {
            // Handle password modal
            if (document.getElementById('passwordModal').classList.contains('show')) {
                if (e.key === 'Enter') {
                    checkPassword();
                } else if (e.key === 'Escape') {
                    closePasswordModal();
                }
                return;
            }
            
            // Don't interfere when editing
            if (currentEditingSection !== null) return;
            
            if (e.key === 'Escape') {
                if (window.innerWidth <= 768) {
                    document.getElementById('sidebar').classList.remove('show');
                }
            } else if (e.key === 'h' && e.ctrlKey) {
                e.preventDefault();
                showHome();
            } else if (e.key === 'a' && e.ctrlKey && e.shiftKey) {
                e.preventDefault();
                if (!isAuthenticated) {
                    showPasswordPrompt();
                } else {
                    toggleEditMode();
                }
            }
        });

        // Handle window resize
        window.addEventListener('resize', function() {
            if (window.innerWidth > 768) {
                document.getElementById('sidebar').classList.remove('show');
            }
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            showHome(); // Start at home page
        });

        // Prevent accidental page reload when editing
        window.addEventListener('beforeunload', function(e) {
            if (currentEditingSection !== null) {
                e.preventDefault();
                e.returnValue = '¿Estás seguro de que quieres salir? Los cambios no guardados se perderán.';
                return e.returnValue;
            }
        });
    </script>
</body>
</html>